{"ast":null,"code":"export default {\n  name: \"ImageCard\",\n  data() {\n    return {\n      url: process.env.VUE_APP_BASE_API + \"/image?id=\",\n      colors: [\"#a3c6ea\", \"#70a8c4\", \"#559bcb\"],\n      labelColor: [\"#77C9D4\", \"#57BC90\", \"#015249\"],\n      imageSource: \"\",\n      isMouseOn: false,\n      tags: [],\n      isCollected: false,\n      dialogVisible: false,\n      isCollectedLoading: false\n    };\n  },\n  computed: {\n    showTags() {\n      if (this.tags.length !== 0) {\n        return this.tags.slice(0, 3);\n      } else {\n        return [\"none\"];\n      }\n    },\n    isTagDisallowed() {\n      if (!this.hideTags) {\n        return true;\n      }\n      for (let i = 0; i < this.tags.length; ++i) {\n        if (this.disallowedTags.indexOf(this.tags[i]) !== -1) {\n          return false;\n        }\n      }\n      return true;\n    }\n  },\n  props: {\n    imageId: String,\n    disallowedTags: Array,\n    hideTags: Boolean\n  },\n  created() {\n    // 获取图片详细信息\n    this.$axios({\n      method: \"get\",\n      url: \"/info\",\n      params: {\n        id: this.imageId\n      }\n    }).then(response => {\n      this.isCollected = response.data.isCollected;\n      this.tags = response.data.tags;\n    }).catch(() => {});\n  },\n  methods: {\n    collectImage() {\n      this.isCollectedLoading = true;\n      this.$axios({\n        method: \"post\",\n        url: \"/collect\",\n        data: {\n          id: this.imageId\n        }\n      }).then(() => {\n        this.isCollected = !this.isCollected;\n        if (this.isCollected) {\n          this.$message({\n            message: \"收藏成功！\",\n            type: \"success\"\n          });\n        } else {\n          this.$message({\n            message: \"已取消收藏\",\n            type: \"success\"\n          });\n        }\n        this.isCollectedLoading = false;\n      }).catch(() => {\n        this.isCollectedLoading = false;\n      }).finally(() => {\n        this.$emit(\"changeCollect\");\n      });\n    },\n    viewImageDetail() {\n      this.dialogVisible = true;\n    }\n  }\n};","map":{"version":3,"names":["name","data","url","process","env","VUE_APP_BASE_API","colors","labelColor","imageSource","isMouseOn","tags","isCollected","dialogVisible","isCollectedLoading","computed","showTags","length","slice","isTagDisallowed","hideTags","i","disallowedTags","indexOf","props","imageId","String","Array","Boolean","created","$axios","method","params","id","then","response","catch","methods","collectImage","$message","message","type","finally","$emit","viewImageDetail"],"sources":["src/components/ImageCard.vue"],"sourcesContent":["<template>\n  <div>\n    <div v-if=\"isTagDisallowed\" class=\"CardContainer\">\n      <div\n        class=\"CardType\"\n      >\n        <!---->\n        <el-image\n          fit=\"fill\"\n          style=\"\n            width: 100%;\n            height: 62%;\n            border-radius: 10px 10px 0 0;\n            box-shadow: rgba(50, 50, 93, 0.25) 0px 2px 5px -1px,\n              rgba(0, 0, 0, 0.3) 0px 1px 3px -1px;\n          \"\n          :src= \"url + imageId\"\n        >\n        </el-image>\n        <el-row style=\"margin-top: 10px\">\n          <el-col :span=\"3\">\n            <!--收藏图片-->\n            <el-tooltip\n              class=\"item\"\n              effect=\"dark\"\n              :content=\"\n                isCollectedLoading\n                  ? '加载中...'\n                  : isCollected\n                  ? '取消收藏'\n                  : '收藏'\n              \"\n              placement=\"top-start\"\n            >\n              <div v-if=\"!isCollectedLoading\">\n                <em\n                  :class=\"isCollected ? 'el-icon-star-on' : 'el-icon-star-off'\"\n                  style=\"font-size: 20px\"\n                  @click=\"collectImage\"\n                ></em>\n              </div>\n              <div v-else>\n                <em class=\"el-icon-loading\" style=\"font-size: 20px\"></em>\n              </div>\n            </el-tooltip>\n          </el-col>\n          <el-col :span=\"3\">\n            <!--查看大图-->\n            <el-tooltip\n              class=\"item\"\n              effect=\"dark\"\n              content=\"查看大图\"\n              placement=\"top-start\"\n            >\n              <em\n                class=\"el-icon-zoom-in\"\n                style=\"font-size: 20px\"\n                @click=\"viewImageDetail\"\n              ></em>\n            </el-tooltip>\n          </el-col>\n          <el-col :span=\"18\">\n            <span> No. {{ imageId }} </span>\n          </el-col>\n        </el-row>\n\n        <div class=\"label-list\">\n          <el-tag\n            type=\"primary\"\n            v-for=\"(i, index) in showTags\"\n            :key=\"index\"\n            effect=\"dark\"\n            :color=\"labelColor[index]\"\n            :hit=\"true\"\n          >\n            {{ i }}\n          </el-tag>\n        </div>\n\n        <el-dialog :visible.sync=\"dialogVisible\" modal width=\"40%\">\n          <img\n            :src=\"url + imageId\"\n            alt=\"\"\n            style=\"width: 100%; height: 100%; object-fit: contain;\"\n          />\n        </el-dialog>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"ImageCard\",\n\n  data() {\n    return {\n      url:  process.env.VUE_APP_BASE_API + \"/image?id=\",\n      colors: [\"#a3c6ea\", \"#70a8c4\", \"#559bcb\"],\n      labelColor: [\"#77C9D4\", \"#57BC90\", \"#015249\"],\n      imageSource: \"\",\n      isMouseOn: false,\n      tags: [],\n      isCollected: false,\n      dialogVisible: false,\n      isCollectedLoading: false,\n    };\n  },\n\n  computed: {\n    showTags() {\n      if (this.tags.length !== 0) {\n        return this.tags.slice(0, 3);\n      } else {\n        return [\"none\"];\n      }\n    },\n    isTagDisallowed() {\n      if (!this.hideTags) {\n        return true;\n      }\n      for (let i = 0; i < this.tags.length; ++i) {\n        if (this.disallowedTags.indexOf(this.tags[i]) !== -1) {\n          return false;\n        }\n      }\n      return true;\n    },\n  },\n\n  props: {\n    imageId: String,\n    disallowedTags: Array,\n    hideTags: Boolean,\n  },\n\n  created() {\n    // 获取图片详细信息\n    this.$axios({\n      method: \"get\",\n      url: \"/info\",\n      params: {\n        id: this.imageId,\n      },\n    })\n      .then((response) => {\n        this.isCollected = response.data.isCollected;\n        this.tags = response.data.tags;\n      })\n      .catch(() => {});\n  },\n\n  methods: {\n    collectImage() {\n      this.isCollectedLoading = true;\n      this.$axios({\n        method: \"post\",\n        url: \"/collect\",\n        data: {\n          id: this.imageId,\n        },\n      })\n        .then(() => {\n          this.isCollected = !this.isCollected;\n          if (this.isCollected) {\n            this.$message({\n              message: \"收藏成功！\",\n              type: \"success\",\n            });\n          } else {\n            this.$message({\n              message: \"已取消收藏\",\n              type: \"success\",\n            })\n          }\n          this.isCollectedLoading = false;\n        })\n        .catch(() => {\n          this.isCollectedLoading = false;\n        })\n        .finally(() => {\n          this.$emit(\"changeCollect\");\n        });\n    },\n    viewImageDetail() {\n      this.dialogVisible = true;\n    },\n  },\n};\n</script>\n\n<style>\n.CardType {\n  width: 95%;\n  height: 95%;\n  margin: 5px auto 0;\n  border-radius: 10px !important;\n  box-shadow: rgba(0, 0, 0, 0.1) 0px 20px 25px -5px,\n    rgba(0, 0, 0, 0.04) 0px 10px 10px -5px !important;\n  background-color: rgba(229, 225, 225, 0.34);\n  cursor: pointer;\n  -webkit-transition: all 200ms ease-in;\n}\n</style>\n\n<style scoped>\n.el-divider--vertical {\n  height: 4em !important;\n  width: 2px !important;\n}\n\n.icon-love {\n  position: absolute;\n  left: 40%;\n  bottom: 40%;\n}\n\n/* 标签列表 */\n.label-list {\n  padding: 1px 1px;\n  margin: 1px 1px;\n}\n.el-tag {\n  float: left;\n  white-space: pre-line;\n  word-break: break-all;\n  margin-top: 5px;\n  margin-left: 5px;\n  max-height: 4vh;\n  color: white;\n}\n\n.CardContainer {\n  width: 270px;\n  height: 290px;\n  margin-bottom: 20px;\n  margin-left: 25px;\n}\n</style>\n"],"mappings":"AA4FA;EACAA,IAAA;EAEAC,KAAA;IACA;MACAC,GAAA,EAAAC,OAAA,CAAAC,GAAA,CAAAC,gBAAA;MACAC,MAAA;MACAC,UAAA;MACAC,WAAA;MACAC,SAAA;MACAC,IAAA;MACAC,WAAA;MACAC,aAAA;MACAC,kBAAA;IACA;EACA;EAEAC,QAAA;IACAC,SAAA;MACA,SAAAL,IAAA,CAAAM,MAAA;QACA,YAAAN,IAAA,CAAAO,KAAA;MACA;QACA;MACA;IACA;IACAC,gBAAA;MACA,UAAAC,QAAA;QACA;MACA;MACA,SAAAC,CAAA,MAAAA,CAAA,QAAAV,IAAA,CAAAM,MAAA,IAAAI,CAAA;QACA,SAAAC,cAAA,CAAAC,OAAA,MAAAZ,IAAA,CAAAU,CAAA;UACA;QACA;MACA;MACA;IACA;EACA;EAEAG,KAAA;IACAC,OAAA,EAAAC,MAAA;IACAJ,cAAA,EAAAK,KAAA;IACAP,QAAA,EAAAQ;EACA;EAEAC,QAAA;IACA;IACA,KAAAC,MAAA;MACAC,MAAA;MACA5B,GAAA;MACA6B,MAAA;QACAC,EAAA,OAAAR;MACA;IACA,GACAS,IAAA,CAAAC,QAAA;MACA,KAAAvB,WAAA,GAAAuB,QAAA,CAAAjC,IAAA,CAAAU,WAAA;MACA,KAAAD,IAAA,GAAAwB,QAAA,CAAAjC,IAAA,CAAAS,IAAA;IACA,GACAyB,KAAA;EACA;EAEAC,OAAA;IACAC,aAAA;MACA,KAAAxB,kBAAA;MACA,KAAAgB,MAAA;QACAC,MAAA;QACA5B,GAAA;QACAD,IAAA;UACA+B,EAAA,OAAAR;QACA;MACA,GACAS,IAAA;QACA,KAAAtB,WAAA,SAAAA,WAAA;QACA,SAAAA,WAAA;UACA,KAAA2B,QAAA;YACAC,OAAA;YACAC,IAAA;UACA;QACA;UACA,KAAAF,QAAA;YACAC,OAAA;YACAC,IAAA;UACA;QACA;QACA,KAAA3B,kBAAA;MACA,GACAsB,KAAA;QACA,KAAAtB,kBAAA;MACA,GACA4B,OAAA;QACA,KAAAC,KAAA;MACA;IACA;IACAC,gBAAA;MACA,KAAA/B,aAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}