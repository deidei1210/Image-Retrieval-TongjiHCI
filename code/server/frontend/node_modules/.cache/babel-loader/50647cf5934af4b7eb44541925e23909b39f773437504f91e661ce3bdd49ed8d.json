{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport ImageCard from \"@/components/ImageCard.vue\";\nexport default {\n  // eslint-disable-next-line\n  name: \"Search\",\n  components: {\n    ImageCard\n  },\n  data() {\n    return {\n      dialogImageUrl: \"\",\n      dialogVisible: false,\n      disabled: false,\n      uploadUrl: process.env.VUE_APP_BASE_API + \"/upload_img\",\n      fileList: [],\n      labelColor: [\"\", \"success\", \"info\", \"warning\", \"danger\"],\n      responseImage: [],\n      filterImage: [],\n      tags: [],\n      disallowedTags: [],\n      collectImage: [],\n      currentPage: 1,\n      isSearching: false,\n      isCollectionLoading: false,\n      num: 9\n    };\n  },\n  created() {\n    this.$axios({\n      method: \"get\",\n      url: \"/tags\"\n    }).then(response => {\n      this.tags = response.data.map(item => {\n        item.status = true;\n        return item;\n      });\n      this.disallowedTags = [];\n    });\n  },\n  methods: {\n    handleRemove() {\n      this.fileList.splice(0, 1);\n    },\n    uploadSuccess(response) {\n      console.log(\"上传成功！\");\n      this.responseImage = response;\n      this.isSearching = false;\n    },\n    handleChange(file) {\n      if (this.fileList.length === 1) {\n        return;\n      }\n      this.fileList = [];\n      this.fileList.push(file);\n    },\n    searchRes() {\n      this.isSearching = true;\n      this.$refs.uploadRef.submit();\n    },\n    tagChange() {\n      let disallowedTags = [];\n      this.tags.forEach(item => {\n        if (!item.status) {\n          disallowedTags.push(item.label);\n        }\n      });\n      this.disallowedTags = disallowedTags;\n    },\n    handleCurrentChange(val) {\n      this.currentPage = val;\n    },\n    getCollection() {\n      this.isCollectionLoading = true;\n      this.$axios({\n        method: \"get\",\n        url: \"/collect/all\"\n      }).then(response => {\n        this.collectImage = response.data;\n      }).finally(() => {\n        this.isCollectionLoading = false;\n      });\n    }\n  }\n};","map":{"version":3,"names":["ImageCard","name","components","data","dialogImageUrl","dialogVisible","disabled","uploadUrl","process","env","VUE_APP_BASE_API","fileList","labelColor","responseImage","filterImage","tags","disallowedTags","collectImage","currentPage","isSearching","isCollectionLoading","num","created","$axios","method","url","then","response","map","item","status","methods","handleRemove","splice","uploadSuccess","console","log","handleChange","file","length","push","searchRes","$refs","uploadRef","submit","tagChange","forEach","label","handleCurrentChange","val","getCollection","finally"],"sources":["src/views/Search.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <div class=\"search-content\">\n      <div class=\"search-upload\">\n        <h3 class=\"search-content-title\" style=\"display:inline-block;\">点我上传图片哦～</h3>\n        <!-- 上传图片的按钮 -->\n        <el-upload :action=uploadUrl :limit=\"1\" list-type=\"picture\" :auto-upload=\"false\" :multiple=\"false\"\n          :file-list=\"fileList\" :on-success=\"uploadSuccess\" :on-change=\"handleChange\" :on-remove=\"handleRemove\"\n          accept=\"image/png, image/jpeg\" ref=\"uploadRef\" :class=\"fileList.length >= 1 ? 'styleA' : 'styleB'\">\n          <!-- 上传图片的按钮 -->\n          <el-button size=\"medium\" type=\"primary\" style=\"display:inline-block;\">\n            <i slot=\"default\" class=\"el-icon-plus\" style=\"margin-right: 5%\"></i>点击上传\n          </el-button>\n        </el-upload>\n      </div>\n      <!-- 显示上传的图片 -->\n      <el-dialog :visible.sync=\"dialogVisible\">\n        <img width=\"70%\" height=\"70%\" :src=\"dialogImageUrl\" alt=\"\" />\n      </el-dialog>\n      <!-- 选择图片展示的数量 -->\n      <el-row class=\"input-row\">\n        <div style=\"display: flex;\">\n          <div style=\"font-size: medium;font-weight: revert;width: 114px;padding-top: ;\">图片展示数量:</div>\n          <el-input-number style=\"margin-left: 1%\" size=\"small\" v-model=\"num\" :min=\"1\" :max=\"9\"></el-input-number>\n          <!-- 搜索按钮 -->\n          <el-button :disabled=\"fileList.length === 0 || isSearching\" @click=\"searchRes\"\n            style=\"margin-top: 2%; z-index: 1000;margin-left: 2%\" type=\"primary\"><i\n              :class=\"isSearching ? 'el-icon-loading' : 'el-icon-search'\" style=\"margin-right: 5%;\" />\n            搜索</el-button>\n        </div>\n      </el-row>\n    </div>\n\n\n    <!-- 分割线 -->\n    <el-divider></el-divider>\n    <div v-if=\"responseImage.length === 0\">\n      <el-empty description=\"No result\" />\n    </div>\n    <div v-else>\n      <el-row>\n        <el-col :span=\"24\">\n          <!--tag list-->\n          <div class=\"label-list\">\n            <el-row>\n              <el-col v-for=\"(item, index) in tags\" :key=\"index\" :span=\"2\">\n                <el-tag :type=\"labelColor[index % labelColor.length]\" :hit=\"true\" style=\"margin-top: 10px\">\n                  <el-checkbox v-model=\"item.status\" @change=\"tagChange\" />\n                  {{ item.label }}({{ item.size }})\n                </el-tag>\n              </el-col>\n            </el-row>\n          </div>\n        </el-col>\n      </el-row>\n\n      <el-divider></el-divider>\n      <el-row style=\"width: 100%\">\n        <el-col :span=\"24\">\n          <div style=\"width: 90%; margin: 0 auto\">\n            <el-row>\n              <el-col v-for=\"(item, index) in responseImage.slice(0, num)\" :key=\"index\" :span=\"6\">\n                <ImageCard :disallowedTags=\"disallowedTags\" :hideTags=\"true\" :imageId=\"item\" />\n              </el-col>\n            </el-row>\n          </div>\n        </el-col>\n      </el-row>\n    </div>\n  </div>\n</template>\n<script>\nimport ImageCard from \"@/components/ImageCard.vue\";\n\nexport default {\n  // eslint-disable-next-line\n  name: \"Search\",\n  components: {\n    ImageCard,\n  },\n  data() {\n    return {\n      dialogImageUrl: \"\",\n      dialogVisible: false,\n      disabled: false,\n      uploadUrl: process.env.VUE_APP_BASE_API + \"/upload_img\",\n      fileList: [],\n      labelColor: [\"\", \"success\", \"info\", \"warning\", \"danger\"],\n      responseImage: [],\n      filterImage: [],\n      tags: [],\n      disallowedTags: [],\n      collectImage: [],\n      currentPage: 1,\n      isSearching: false,\n      isCollectionLoading: false,\n\n      num: 9,\n    };\n  },\n  created() {\n    this.$axios({\n      method: \"get\",\n      url: \"/tags\",\n    }).then((response) => {\n      this.tags = response.data.map((item) => {\n        item.status = true;\n        return item;\n      });\n      this.disallowedTags = [];\n    });\n  },\n  methods: {\n    handleRemove() {\n      this.fileList.splice(0, 1);\n    },\n    uploadSuccess(response) {\n      console.log(\"上传成功！\");\n      this.responseImage = response;\n      this.isSearching = false;\n    },\n    handleChange(file) {\n      if (this.fileList.length === 1) {\n        return;\n      }\n      this.fileList = [];\n      this.fileList.push(file);\n    },\n    searchRes() {\n      this.isSearching = true;\n      this.$refs.uploadRef.submit();\n    },\n    tagChange() {\n      let disallowedTags = [];\n      this.tags.forEach((item) => {\n        if (!item.status) {\n          disallowedTags.push(item.label);\n        }\n      });\n      this.disallowedTags = disallowedTags;\n    },\n    handleCurrentChange(val) {\n      this.currentPage = val;\n    },\n    getCollection() {\n      this.isCollectionLoading = true;\n      this.$axios({\n        method: \"get\",\n        url: \"/collect/all\",\n      })\n        .then((response) => {\n          this.collectImage = response.data;\n        })\n        .finally(() => {\n          this.isCollectionLoading = false;\n        });\n    },\n  },\n};\n</script>\n<style scoped>\n.search-upload,\n.select-show-num {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n}\n.input-row {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.input-row > * + * {\n  margin-left: 10px;\n}\n\n.input-row span {\n  font-size: medium;\n  font-weight: revert;\n}\n\n.el-button {\n  margin-top: 20px;\n  margin-bottom: 20px;\n}\n</style>\n"],"mappings":";AAwEA,OAAAA,SAAA;AAEA;EACA;EACAC,IAAA;EACAC,UAAA;IACAF;EACA;EACAG,KAAA;IACA;MACAC,cAAA;MACAC,aAAA;MACAC,QAAA;MACAC,SAAA,EAAAC,OAAA,CAAAC,GAAA,CAAAC,gBAAA;MACAC,QAAA;MACAC,UAAA;MACAC,aAAA;MACAC,WAAA;MACAC,IAAA;MACAC,cAAA;MACAC,YAAA;MACAC,WAAA;MACAC,WAAA;MACAC,mBAAA;MAEAC,GAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,MAAA;MACAC,MAAA;MACAC,GAAA;IACA,GAAAC,IAAA,CAAAC,QAAA;MACA,KAAAZ,IAAA,GAAAY,QAAA,CAAAxB,IAAA,CAAAyB,GAAA,CAAAC,IAAA;QACAA,IAAA,CAAAC,MAAA;QACA,OAAAD,IAAA;MACA;MACA,KAAAb,cAAA;IACA;EACA;EACAe,OAAA;IACAC,aAAA;MACA,KAAArB,QAAA,CAAAsB,MAAA;IACA;IACAC,cAAAP,QAAA;MACAQ,OAAA,CAAAC,GAAA;MACA,KAAAvB,aAAA,GAAAc,QAAA;MACA,KAAAR,WAAA;IACA;IACAkB,aAAAC,IAAA;MACA,SAAA3B,QAAA,CAAA4B,MAAA;QACA;MACA;MACA,KAAA5B,QAAA;MACA,KAAAA,QAAA,CAAA6B,IAAA,CAAAF,IAAA;IACA;IACAG,UAAA;MACA,KAAAtB,WAAA;MACA,KAAAuB,KAAA,CAAAC,SAAA,CAAAC,MAAA;IACA;IACAC,UAAA;MACA,IAAA7B,cAAA;MACA,KAAAD,IAAA,CAAA+B,OAAA,CAAAjB,IAAA;QACA,KAAAA,IAAA,CAAAC,MAAA;UACAd,cAAA,CAAAwB,IAAA,CAAAX,IAAA,CAAAkB,KAAA;QACA;MACA;MACA,KAAA/B,cAAA,GAAAA,cAAA;IACA;IACAgC,oBAAAC,GAAA;MACA,KAAA/B,WAAA,GAAA+B,GAAA;IACA;IACAC,cAAA;MACA,KAAA9B,mBAAA;MACA,KAAAG,MAAA;QACAC,MAAA;QACAC,GAAA;MACA,GACAC,IAAA,CAAAC,QAAA;QACA,KAAAV,YAAA,GAAAU,QAAA,CAAAxB,IAAA;MACA,GACAgD,OAAA;QACA,KAAA/B,mBAAA;MACA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}